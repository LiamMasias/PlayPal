<%- include ('../partials/head') %> <%- include ('../partials/menu') %>

<main>
  <div class="container" style="background-color: #373737; color: white">
    <div class="game-info text-left">
      <h1><%= IGDB[0].name %></h1>

      <div style="display: flex; padding-bottom: 18px;">

        <div style="flex: 1;">
          <div class="content-warnings">
            <% try { %>
            <% let allDescriptions = ""; IGDB[0].age_ratings[1].content_descriptions.forEach((desc, index) => { allDescriptions +=
            `${desc.description}`; if (index < IGDB[0].age_ratings[1].content_descriptions.length - 1) { allDescriptions += ', '; } });
            %>
            <h5>Content Warnings: <%= allDescriptions.trim() %></h5>
            <% } catch (error) { %> None to be listed <% } %>
          </div>
      
          <div class="user-ratings">
            <h5>User Ratings: <%= parseInt(IGDB[0].aggregated_rating) %></h5>
          </div>
          <div style="margin-bottom: 2%;" class="progress" role="progressbar" aria-label="Animated striped example" aria-valuenow="<%= IGDB[0].aggregated_rating %>" aria-valuemin="0" aria-valuemax="100">
            <div class="progress-bar progress-bar-striped progress-bar-animated" style="width: <%= parseInt(IGDB[0].aggregated_rating)%>%"></div>
          </div>
        </div>
        

        <div class="save-game" style="flex: 1">
          <h5>Save Game Into Your Collection!</h5>
          <!-- Save into allocated table depending on symbol pressed -->
          <div class="row">
            <div class="container saveGameButton col-md-6">
              <a href="#"><img style="background-color: red;" src="/img/TrophyIcon.png" class="card-img-top saveGameButtonImg" alt="Played Icon"></a>
              <p style="text-align: center;">Played</p>
            </div>
            <div class="container saveGameButton col-md-6">
              <a href="#"><img style="background-color: green;" src="/img/SaveIcon.png" class="card-img-top saveGameButtonImg" alt="Current Icon"></a>
              <p style="text-align: center;">Currently Playing</p>
            </div>
            <div class="container saveGameButton col-md-6">
              <a href="#"><img style="background-color: blue;" src="/img/WishlistIcon.png" class="card-img-top saveGameButtonImg" alt="Want to Play Icon"></a>
              <p style="text-align: center;">Want to Play</p>
            </div>
          </div>
        </div>
      
        <div class="col-md-3">
          <h5>PlayPal Reviews</h5>
          <a href="/reviews/<%= IGDB[0].id %>" class="btn btn-danger">Check User Reviews!</a>
          <a href="http://localhost:3000/addReview/" style="margin-top: 10pt;" class="btn btn-danger">Add Your Review</a>
        </div>

        

      </div>
      <div style="display: flex;">

        <div style="flex: 0 0 auto;">
          <img
            src="<%= 'https://images.igdb.com/igdb/image/upload/t_cover_big/' + IGDB[0].cover.image_id + '.jpg' %>"
            alt="Game Screenshot"
            height="500"
          />
        </div>
      
        <div style="position: relative; flex: 1 1 auto;">
      
          <div
            id="screenshot-carousel"
            class="carousel slide"
            data-ride="carousel"
          >
            <div class="carousel-inner">
              <% IGDB[0].screenshots.forEach((screenshot, index) => { %>
              <div class="carousel-item <%= index === 0 ? 'active' : '' %>">
                <img
                  src="<%= 'https://images.igdb.com/igdb/image/upload/t_screenshot_big/' + screenshot.image_id + '.jpg' %>"
                  class="d-block w-100"
                  alt="Screenshot"
                  height="500"
                />
              </div>
              <% }); %>
            </div>
            <a
              class="carousel-control-prev"
              href="#screenshot-carousel"
              role="button"
              data-slide="prev"
            >
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a
              class="carousel-control-next"
              href="#screenshot-carousel"
              role="button"
              data-slide="next"
            >
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
      </div>
      <div id = "summary" style="padding-top: 5px;">      <h6><%= IGDB[0].summary %></h6>
      </div>

      <div class="row">
        <div class="where-to-buy col-md-6">
          <h1>Where to Buy:</h1>
          <h2>
            <a  class="btn btn-danger" href="https://www.target.com/s?searchTerm=<%= IGDB[0].name %>"
              >Target</a
            >
          </h2>
          <h2>
            <a  class="btn btn-danger" href="https://www.amazon.com/s?k=<%= IGDB[0].name %>">Amazon</a>
          </h2>
          <h2>
            <a  class="btn btn-danger" href="https://www.gamestop.com/search/?q=<%= IGDB[0].name %>"
              >GameStop</a
            >
          </h2>
        </div>

        <div class="Platforms col-md-6 row">
          <h1>Available Platforms:</h1>
          <!-- Need to have ejs statement to see if platform is true for each. If has playstation, include this, if xbox, etc...: -->
          <div class="col-md-3">
            <h2>
              <a  class="btn" href="https://www.playstation.com/en-us/search/?q=<%= IGDB[0].name %>"
                ><img class="saveGameButton" src="/img/playstation.svg" alt="Playstation Store URL"></a>
            </h2>
          </div>
          <div class="col-md-3">
            <h2>
              <a  class="btn" href="https://www.xbox.com/en-us/search/?q=<%= IGDB[0].name %>"
                ><img class="saveGameButton" src="/img/xbox.png" alt="Xbox Store URL"></a>
            </h2>
          </div>
          <div class="col-md-3">
            <h2>
              <a  class="btn" href="https://store.steampowered.com/search/?term=<%= IGDB[0].name %>"
                ><img class="saveGameButton" src="/img/Steam.png" alt="Steam Store URL"></a>
            </h2>
          </div>
          <div class="col-md-3">
            <h2>
              <a  class="btn" href="https://www.nintendo.com/us/search/#q=<%= IGDB[0].name %>"
                ><img class="saveGameButton" src="/img/Nintendo.svg" alt="Steam Store URL"></a>
            </h2>
          </div>
        </div>
    </div>
  
    </div>

    </div>
  </div>
  <div id = "whitespace" style="height: 50px;">

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script>
    $(document).ready(function () {
      $("#screenshot-carousel").carousel();
    });
  </script>
</main>

<%- include ('../partials/footer') %>
